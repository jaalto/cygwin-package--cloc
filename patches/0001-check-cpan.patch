From b7a2ef4e2cb0a801af76b1f02bc343f114de16c7 Mon Sep 17 00:00:00 2001
From: Jari Aalto <jari.aalto@cante.net>
Date: Sat, 4 Feb 2012 21:44:04 +0200
Subject: [PATCH] check cpan
Organization: Private
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 8bit

Signed-off-by: Jari Aalto <jari.aalto@cante.net>
---
 cloc |   24 ++++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 mode change 100644 => 100755 cloc

--- a/cloc
+++ b/cloc
@@ -45,6 +45,30 @@ use File::Spec;
 use IO::File;
 use POSIX "strftime";
 
+BEGIN
+{
+    my @need = qw
+    (
+        Algorithm::Diff
+        Regexp::Common
+    );
+
+    my @list;
+
+    for ( @need )
+    {
+        eval "use $_;" ;
+        push @list, $_   if $@;  # Eval error
+    }
+
+    if ( @list )
+    {
+        die q([FATAL] Perl CPAN modules are needed. Please install them with:
+
+              cpan ) . qq(@list\n);
+    }
+}
+
 # Digest::MD5 isn't in the standard distribution. Use it only if installed.
 my $HAVE_Digest_MD5 = 0;
 eval "use Digest::MD5;";
